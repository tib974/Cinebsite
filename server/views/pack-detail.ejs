<header class="page-header">
  <div>
    <h2><%= pack.name %></h2>
    <p style="margin:0;color:#94a3b8;">Slug : <code><%= pack.slug %></code></p>
  </div>
  <a class="button-link" href="/admin/packs">← Retour</a>
</header>

<form class="form-card" method="post" action="/admin/packs/<%= pack.id %>">
  <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
  <div>
    <label for="name">Nom</label>
    <input id="name" name="name" type="text" required value="<%= pack.name %>" />
  </div>
  <div>
    <label for="slug">Slug</label>
    <input id="slug" name="slug" type="text" required value="<%= pack.slug %>" />
  </div>
  <div>
    <label for="dailyPrice">Tarif journalier (€)</label>
    <input id="dailyPrice" name="dailyPrice" type="number" step="0.01" required value="<%= pack.dailyPrice %>" />
  </div>
  <div>
    <label for="imageUrl">URL image</label>
    <input id="imageUrl" name="imageUrl" type="text" value="<%= pack.imageUrl || '' %>" />
  </div>
  <div>
    <label for="description">Description</label>
    <textarea id="description" name="description"><%= pack.description || '' %></textarea>
  </div>

  <fieldset>
    <legend>Composition du pack</legend>
    <div class="quote-items" id="pack-items">
      <% if (pack.items.length === 0) { %>
        <p class="muted">Ce pack ne contient pas encore de matériel. Ajoutez des éléments ci-dessous.</p>
      <% } %>
      <% pack.items.forEach((item) => { %>
        <div class="grid two" style="align-items:end;">
          <div>
            <label>Produit</label>
            <select name="itemProductId" required>
              <option value="">Sélectionner…</option>
              <% products.forEach((product) => { %>
                <option value="<%= product.id %>" <%= product.id === item.productId ? 'selected' : '' %>>
                  <%= product.name %> (<%= product.dailyPrice.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' }) %>)
                </option>
              <% }) %>
            </select>
          </div>
          <div>
            <label>Quantité</label>
            <input type="number" name="itemQuantity" min="1" value="<%= item.quantity %>" />
          </div>
        </div>
      <% }) %>
      <div class="grid two" style="align-items:end;">
        <div>
          <label>Produit</label>
          <select name="itemProductId">
            <option value="">Sélectionner…</option>
            <% products.forEach((product) => { %>
              <option value="<%= product.id %>"><%= product.name %></option>
            <% }) %>
          </select>
        </div>
        <div>
          <label>Quantité</label>
          <input type="number" name="itemQuantity" min="1" value="1" />
        </div>
      </div>
    </div>
    <p class="muted" style="margin:12px 0 0;">Ajoutez autant de lignes que nécessaire puis sauvegardez. Les lignes vides sont ignorées.</p>
  </fieldset>

  <div class="actions">
    <button type="submit">Enregistrer</button>
    <form action="/admin/packs/<%= pack.id %>/delete" method="post" onsubmit="return confirm('Supprimer ce pack ?');">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
      <button type="submit" class="danger">Supprimer</button>
    </form>
  </div>
</form>
